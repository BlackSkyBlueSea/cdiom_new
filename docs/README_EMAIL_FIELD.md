# 用户邮箱字段说明

## 概述

系统为用户表添加了 `email` 字段，用于存储用户邮箱地址。该字段主要用于超级管理员启用/禁用操作的安全验证。

## 字段特性

1. **可为空**：普通用户的邮箱字段可以为 `NULL`（不是必填项）
2. **唯一性**：非 `NULL` 的邮箱值必须唯一（通过数据库唯一索引保证）
3. **超级管理员要求**：超级管理员账户必须绑定邮箱，用于启用/禁用操作的验证

## 数据库迁移

### 对于新数据库

如果是从零开始创建数据库，`init.sql` 已经包含了 `email` 字段的定义，无需额外操作。

### 对于现有数据库

如果数据库中已有用户数据，需要执行迁移脚本：

```sql
-- 执行迁移脚本
source add_user_email_field.sql;
```

或者直接在数据库中执行 `add_user_email_field.sql` 文件的内容。

## 使用说明

### 1. 普通用户

- 邮箱字段为**可选**，可以不填写
- 如果填写，必须保证唯一性（不能与其他用户的邮箱重复）

### 2. 超级管理员

- 邮箱字段为**必填**，必须绑定一个有效的邮箱地址
- 该邮箱用于启用/禁用超级管理员账户时的验证
- 只有使用绑定的邮箱才能进行启用/禁用操作

### 3. 设置超级管理员邮箱

可以通过以下方式设置超级管理员邮箱：

#### 方式一：通过初始化脚本

在 `init_super_admin.sql` 中设置：

```sql
UPDATE `sys_user` 
SET `email` = 'your-email@example.com'  -- 替换为实际的邮箱地址
WHERE `username` = 'super_admin';
```

#### 方式二：通过用户管理界面

1. 登录系统管理员账户
2. 进入"用户管理"页面
3. 编辑超级管理员用户（username = 'super_admin'）
4. 在"邮箱"字段中输入邮箱地址
5. 保存

## 安全说明

1. **邮箱验证**：超级管理员的启用/禁用操作必须使用账户绑定的邮箱进行验证
2. **唯一性保证**：数据库唯一索引确保邮箱的唯一性
3. **应用层验证**：后端代码会验证邮箱是否匹配，防止使用任意邮箱进行操作

## 注意事项

1. 如果超级管理员账户没有绑定邮箱，将无法进行启用/禁用操作
2. 修改超级管理员邮箱后，需要使用新邮箱进行后续的启用/禁用操作
3. 邮箱地址建议使用真实有效的邮箱，确保能正常接收验证码邮件

